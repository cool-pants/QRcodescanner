<template>
  <img alt="Vue logo" src="./assets/logo.png" />
  <br>
  <div v-if="logged">
    <button @click="toggleQRScan">
      <svg width="96" height="48" viewBox="0 0 96 48" fill="none" xmlns="http://www.w3.org/2000/svg">
      <rect width="96" height="48" rx="20" fill="#AFF6C6"/>
      <path d="M33.687 25.1479C32.9634 24.9399 32.436 24.6851 32.105 24.3833C31.7769 24.0786 31.6128 23.7036 31.6128 23.2583C31.6128 22.7544 31.8135 22.3384 32.2148 22.0103C32.6191 21.6792 33.1436 21.5137 33.7881 21.5137C34.2275 21.5137 34.6187 21.5986 34.9614 21.7686C35.3071 21.9385 35.5737 22.1729 35.7612 22.4717C35.9517 22.7705 36.0469 23.0972 36.0469 23.4517H35.1987C35.1987 23.0649 35.0757 22.7617 34.8296 22.542C34.5835 22.3193 34.2363 22.208 33.7881 22.208C33.3721 22.208 33.0469 22.3003 32.8125 22.4849C32.5811 22.6665 32.4653 22.9199 32.4653 23.2451C32.4653 23.5059 32.5752 23.7271 32.7949 23.9087C33.0176 24.0874 33.394 24.2515 33.9243 24.4009C34.4575 24.5503 34.8735 24.7158 35.1724 24.8975C35.4741 25.0762 35.6968 25.2856 35.8403 25.5259C35.9868 25.7661 36.0601 26.0488 36.0601 26.374C36.0601 26.8926 35.8579 27.3086 35.4536 27.6221C35.0493 27.9326 34.5088 28.0879 33.832 28.0879C33.3926 28.0879 32.9824 28.0044 32.6016 27.8374C32.2207 27.6675 31.9263 27.436 31.7183 27.1431C31.5132 26.8501 31.4106 26.5176 31.4106 26.1455H32.2588C32.2588 26.5322 32.4009 26.8384 32.6851 27.064C32.9722 27.2866 33.3545 27.3979 33.832 27.3979C34.2773 27.3979 34.6187 27.3071 34.856 27.1255C35.0933 26.9438 35.2119 26.6963 35.2119 26.3828C35.2119 26.0693 35.1021 25.8276 34.8823 25.6577C34.6626 25.4849 34.2642 25.3149 33.687 25.1479ZM38.9253 27.4243C39.2153 27.4243 39.4688 27.3364 39.6855 27.1606C39.9023 26.9849 40.0225 26.7651 40.0459 26.5015H40.8149C40.8003 26.7739 40.7065 27.0332 40.5337 27.2793C40.3608 27.5254 40.1294 27.7217 39.8394 27.8682C39.5522 28.0146 39.2476 28.0879 38.9253 28.0879C38.2778 28.0879 37.7622 27.8726 37.3784 27.4419C36.9976 27.0083 36.8071 26.4165 36.8071 25.6665V25.5303C36.8071 25.0674 36.8921 24.6558 37.062 24.2954C37.2319 23.9351 37.4751 23.6553 37.7915 23.4561C38.1108 23.2568 38.4873 23.1572 38.9209 23.1572C39.4541 23.1572 39.8965 23.3169 40.248 23.6362C40.6025 23.9556 40.7915 24.3701 40.8149 24.8799H40.0459C40.0225 24.5723 39.9053 24.3203 39.6943 24.124C39.4863 23.9248 39.2285 23.8252 38.9209 23.8252C38.5078 23.8252 38.187 23.9746 37.9585 24.2734C37.7329 24.5693 37.6201 24.9985 37.6201 25.561V25.7148C37.6201 26.2627 37.7329 26.6846 37.9585 26.9805C38.1841 27.2764 38.5063 27.4243 38.9253 27.4243ZM44.6646 28C44.6177 27.9062 44.5796 27.7393 44.5503 27.499C44.1724 27.8916 43.7212 28.0879 43.1968 28.0879C42.728 28.0879 42.3428 27.9561 42.041 27.6924C41.7422 27.4258 41.5928 27.0889 41.5928 26.6816C41.5928 26.1865 41.7803 25.8027 42.1553 25.5303C42.5332 25.2549 43.0635 25.1172 43.7461 25.1172H44.5371V24.7437C44.5371 24.4595 44.4521 24.2339 44.2822 24.0669C44.1123 23.897 43.8618 23.812 43.5308 23.812C43.2407 23.812 42.9976 23.8853 42.8013 24.0317C42.605 24.1782 42.5068 24.3555 42.5068 24.5635H41.6895C41.6895 24.3262 41.7729 24.0977 41.9399 23.8779C42.1099 23.6553 42.3384 23.4795 42.6255 23.3506C42.9155 23.2217 43.2334 23.1572 43.5791 23.1572C44.127 23.1572 44.5562 23.2949 44.8667 23.5703C45.1772 23.8428 45.3384 24.2192 45.3501 24.6997V26.8882C45.3501 27.3247 45.4058 27.6719 45.5171 27.9297V28H44.6646ZM43.3154 27.3804C43.5703 27.3804 43.812 27.3145 44.0405 27.1826C44.269 27.0508 44.4346 26.8794 44.5371 26.6685V25.6929H43.8999C42.9038 25.6929 42.4058 25.9844 42.4058 26.5674C42.4058 26.8223 42.4907 27.0215 42.6606 27.165C42.8306 27.3086 43.0488 27.3804 43.3154 27.3804ZM47.3936 23.2451L47.4199 23.8428C47.7832 23.3857 48.2578 23.1572 48.8438 23.1572C49.8486 23.1572 50.3555 23.7241 50.3643 24.8579V28H49.5513V24.8535C49.5483 24.5107 49.4692 24.2573 49.314 24.0933C49.1616 23.9292 48.9229 23.8472 48.5977 23.8472C48.334 23.8472 48.1025 23.9175 47.9033 24.0581C47.7041 24.1987 47.5488 24.3833 47.4375 24.6118V28H46.6245V23.2451H47.3936ZM58.8369 25.0073C58.8369 25.6255 58.7388 26.1587 58.5425 26.6069C58.3462 27.0522 58.0708 27.4009 57.7163 27.6528L58.8589 28.5493L58.2832 29.0811L56.9341 28.0088C56.7231 28.0615 56.5005 28.0879 56.2661 28.0879C55.7622 28.0879 55.3154 27.9648 54.9258 27.7188C54.5361 27.4697 54.2329 27.1167 54.0161 26.6597C53.8022 26.1997 53.6924 25.668 53.6865 25.0645V24.603C53.6865 23.9878 53.7935 23.4443 54.0073 22.9727C54.2212 22.501 54.5229 22.1406 54.9126 21.8916C55.3052 21.6396 55.7534 21.5137 56.2573 21.5137C56.7729 21.5137 57.2256 21.6382 57.6152 21.8872C58.0078 22.1362 58.3096 22.4951 58.5205 22.9639C58.7314 23.4297 58.8369 23.9746 58.8369 24.5986V25.0073ZM57.9932 24.5942C57.9932 23.8413 57.8423 23.2612 57.5405 22.854C57.2417 22.4438 56.814 22.2388 56.2573 22.2388C55.7271 22.2388 55.3081 22.4424 55.0005 22.8496C54.6958 23.2539 54.5391 23.8164 54.5303 24.5371V25.0073C54.5303 25.7397 54.6826 26.3169 54.9873 26.7388C55.2949 27.1606 55.7212 27.3716 56.2661 27.3716C56.811 27.3716 57.2329 27.1738 57.5317 26.7783C57.8306 26.3799 57.9844 25.8101 57.9932 25.0688V24.5942ZM62.4844 25.4116H60.9814V28H60.1333V21.6016H62.2515C62.9722 21.6016 63.5259 21.7656 63.9126 22.0938C64.3022 22.4219 64.4971 22.8994 64.4971 23.5264C64.4971 23.9248 64.3887 24.272 64.1719 24.5679C63.958 24.8638 63.6592 25.085 63.2754 25.2314L64.7783 27.9473V28H63.873L62.4844 25.4116ZM60.9814 24.7217H62.2778C62.6968 24.7217 63.0293 24.6133 63.2754 24.3965C63.5244 24.1797 63.6489 23.8896 63.6489 23.5264C63.6489 23.1309 63.5303 22.8276 63.293 22.6167C63.0586 22.4058 62.7188 22.2988 62.2734 22.2959H60.9814V24.7217Z" fill="black"/>
      </svg>
    </button>
    <br>
    <teleport to="#modal-wrapper">
      <QRModal v-if="scanOpen" @close="toggleQRScan"/>
    </teleport>
    <table class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Vehicle</th>
                    <th>Entry Time</th>
                </tr>
            </thead>
            <tbody>
                <tr v-for="d in data">
                    <td>{{d.data[1][2]}}</td>
                    <td>{{d.data[0]}}</td>
                    <td>{{d.enter}}</td>
                </tr>
            </tbody>
        </table>
  </div>
  <div v-else>
    <Logged @log="toggleLog"/>
  </div>

</template>

<script>
import { ref } from "vue"
import HelloWorld from './components/HelloWorld.vue'
import QRModal from './components/QrModal.vue'
import Logged from './components/Logged.vue'
import { getts } from './handlers/filehandling'

export default {
  name: 'App',

  setup(props){
    const data=ref({});
    const logged = ref(false);
    const scanOpen = ref(false);
    const toggleQRScan = () => {
      scanOpen.value = !scanOpen.value;
      data.value = getts();
      console.log(data.value);
      return data;
    };
    const toggleLog = () => {
      logged.value = !logged.value;
    }

    return {
      data,
      logged,
      toggleLog,
      scanOpen,
      toggleQRScan
    }
  },
  
  components: {
    HelloWorld,
    QRModal,
    Logged
  }
}
</script>

<style scoped>
@import './assets/qrmodal.css'
</style>
